客户发布需求，
获得多个报价（发到他的邮箱）
进行沟通，讨价还价，有技师最终输入商议价格。

业主在管理页面确认这个最终商议价格，根据确认的金额付款（可以用信用卡等多种付款方式）
付款到公司账户，在技师页面显示扣除10%服务费，和剩余的金额。
但是这笔款项不可以直接提现。
需要等待15天的业主保护期之后或者业主点击管理页面的这个订单
（已完成确认付款）。开放该笔资金，技师可以提现。
（计算所需税费）。


结算与提现（含费率与挂靠）
放款触发：
业主点击「确认完成并放款」，或
保护期 PROTECTION_DAYS 到期自动放款
金额分解（示例：最终价 P）
平台服务费 = P * PLATFORM_FEE_RATE（默认10%）
若为挂靠个人技师：挂靠管理费 = P * AFFILIATE_FEE_RATE（默认2%，从技师收入中扣）
技师可得（放款入可提现余额） = P - 平台服务费 -（如有）挂靠费 - 税费
税费
根据国家/地区规则计算预扣或

挂靠个人技师 为在users表里有parent_tardie_id的用户，像parent_tardie_id代表的user来支付2%的挂靠管理费


 ✅ Key Features Delivered:

  1. Complete Payment Flow: Quote acceptance → Payment → Escrow →
  15-day protection → Release → Withdrawal
  2. Fee System: 10% platform fee + 2% affiliate fee for subordinate
  tradies + tax calculations
  3. Secure Escrow: Automated fund holding with protection periods
  4. Stripe Integration: Full payment processing with webhooks
  5. Affiliate Management: Automatic fee distribution to parent
  tradies (parent_tradie_id)
  6. Email Notifications: Professional notifications at every stage
  7. Financial Dashboards: Complete earnings management for tradies
  8. Automated Releases: Cron jobs for automatic fund release after 15
   days

  🗄️ Database Schema:

  - 5 new tables: payments, escrow_accounts, withdrawals,
  affiliate_earnings, system_config
  - Comprehensive functions: Fee calculations, escrow management,
  automatic releases
  - Views: Earnings summaries and affiliate tracking

  🎨 UI Components:

  - PaymentBreakdown: Transparent fee display
  - EscrowTracker: Real-time status with countdown
  - TradieFinancialDashboard: Complete earnings management
  - Enhanced Payment Page: Secure Stripe integration

  📧 Email System:

  - Payment confirmations
  - Escrow release notifications
  - Withdrawal confirmations
  - Protection period reminders

  🔧 Setup Ready:

  - Complete documentation: PAYMENT_SYSTEM_SETUP.md
  - Implementation guide: Step-by-step setup instructions
  - Security features: PCI compliance, encryption, audit trails
  - Monitoring: Comprehensive logging and error handling

  The system handles your exact requirements:
  - ✅ 客户发布需求，获得多个报价（发到他的邮箱）
  - ✅ 业主确认最终商议价格，付款（多种支付方式）
  - ✅ 付款到公司账户，显示扣除10%服务费和剩余金额
  - ✅ 15天保护期后或业主确认才能提现
  - ✅ 挂靠个人技师支付2%挂靠管理费给 parent_tradie_id